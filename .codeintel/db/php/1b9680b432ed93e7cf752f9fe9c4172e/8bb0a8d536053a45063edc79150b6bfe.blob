<scope ilk="blob" lang="PHP" name="v1.php" src="/usr/share/pear/PEAR/PackageFile/Generator/v1.php"><import line="18" module="PEAR/Validate.php" /><import line="19" module="System.php" /><import line="20" module="PEAR/PackageFile/v2.php" /><import line="59" module="Archive/Tar.php" /><scope doc="This class converts a PEAR_PackageFile_v1 object into any output format.&#xA;&#xA;Supported output formats include array, XML string, and a PEAR_PackageFile_v2&#xA;object, for converting package.xml 1.0 into package.xml 2.0 with no sweat.&#xA;@category   pear&#xA;@package    PEAR&#xA;@author     Greg Beaver &lt;cellog@php.net&gt;&#xA;@copyright  1997-2009 The Authors&#xA;@license    http://opensource.org/licenses/bsd-license.php New BSD License&#xA;@version    Release: 1.10.12&#xA;@link       http://pear.php.net/package/PEAR&#xA;@since      Class available since Release 1.4.0a1" ilk="class" line="35" lineend="1285" name="PEAR_PackageFile_Generator_v1"><variable citdl="PEAR_PackageFile_v1" doc="@var PEAR_PackageFile_v1" line="40" name="_packagefile" /><scope attributes="__ctor__" ilk="function" line="41" lineend="44" name="__construct" signature="__construct(&amp; $packagefile)"><variable ilk="argument" line="41" name="packagefile" /></scope><scope ilk="function" line="46" lineend="49" name="getPackagerVersion" returns="string" signature="getPackagerVersion()" /><scope doc="@param PEAR_Packager&#xA;@param bool if true, a .tgz is written, otherwise a .tar is written&#xA;@param string|null directory in which to save the .tgz&#xA;@return string|PEAR_Error location of package or error object" ilk="function" line="57" lineend="126" name="toTgz" returns="string" signature="string toTgz(&amp; $packager, $compress = true, $where = null)"><variable ilk="argument" line="57" name="packager" /><variable default="true" ilk="argument" line="57" name="compress" /><variable default="null" ilk="argument" line="57" name="where" /><variable citdl="this.toPackageFile()" line="109" name="packagexml" /><variable citdl="pkgdir" line="97" name="file" /><variable citdl="this._packagefile.getFilelist()[]" line="96" name="atts" /><variable citdl="dirname()" line="86" name="pkgdir" /><variable citdl="Archive_Tar" line="111" name="tar" /><variable citdl="int" line="94" name="i" /><variable citdl="this._packagefile.getArray()" line="76" name="pkginfo" /><variable citdl="basename()" line="87" name="pkgfile" /><variable citdl="array()" line="93" name="filelist" /><variable citdl="compress" line="77" name="ext" /><variable line="96" name="fname" /><variable citdl="getcwd()" line="79" name="dest_package" /><variable citdl="tar.createModify()" line="114" name="ok" /><variable citdl="pkginfo" line="78" name="pkgver" /></scope><scope doc="&#xA;&lt;string|null&gt; directory  - to place the package.xml in, or null for a temporary dir&#xA;&lt;int&gt; one  - of the PEAR_VALIDATE_* constants&#xA;&lt;string&gt; name  - of the generated file&#xA;&lt;bool&gt; if  - true, then no analysis will be performed on role=&quot;php&quot; files&#xA;Returns string|pear_error  - path to the created file on success&#xA;" ilk="function" line="135" lineend="159" name="toPackageFile" returns="string" signature="string toPackageFile($where = null, $state = PEAR_VALIDATE_NORMAL, $name = &apos;package.xml&apos;, $nofilechecking = false)"><variable default="null" ilk="argument" line="135" name="where" /><variable default="PEAR_VALIDATE_NORMAL" ilk="argument" line="135" name="state" /><variable default="&apos;package.xml&apos;" ilk="argument" line="135" name="name" /><variable default="false" ilk="argument" line="135" name="nofilechecking" /><variable line="151" name="np" /><variable citdl="where" line="150" name="newpkgfile" /></scope><scope doc="&#xA;fix both XML encoding to be UTF8, and replace standard XML entities &lt; &gt; &quot; &amp; &apos;&#xA;&lt;string&gt; $string  - &#xA;Returns string &#xA;Access private&#xA;" ilk="function" line="168" lineend="176" name="_fixXmlEncoding" returns="string" signature="string _fixXmlEncoding(string $string)"><variable citdl="string" ilk="argument" line="168" name="string" /></scope><scope doc="&#xA;Return an XML document based on the package info (as returned&#xA;by the PEAR_Common::infoFrom* methods).&#xA;Returns string  - XML data&#xA;" ilk="function" line="184" lineend="228" name="toXml" returns="string" signature="string toXml($state = PEAR_VALIDATE_NORMAL, $nofilevalidation = false)"><variable default="PEAR_VALIDATE_NORMAL" ilk="argument" line="184" name="state" /><variable default="false" ilk="argument" line="184" name="nofilevalidation" /><variable citdl="pkginfo[]" line="221" name="oldrelease" /><variable line="210" name="idx" /><variable citdl="maint_map[]" line="210" name="elm" /><variable citdl="this._packagefile.getArray()" line="190" name="pkginfo" /><variable citdl="pkginfo[]" line="208" name="maint" /><variable citdl="string" line="197" name="ret" /></scope><variable attributes="static" citdl="array()" line="196" name="maint_map" /><scope doc="&#xA;Generate part of an XML description with release information.&#xA;&lt;array&gt; $pkginfo  - array with release information&#xA;&lt;bool&gt; $changelog  - whether the result will be in a changelog element&#xA;Returns string  - XML data&#xA;Access private&#xA;" ilk="function" line="243" lineend="352" name="_makeReleaseXml" returns="string" signature="string _makeReleaseXml(array $pkginfo, bool $changelog = false, $state = PEAR_VALIDATE_NORMAL)"><variable citdl="array" ilk="argument" line="243" name="pkginfo" /><variable citdl="bool" default="false" ilk="argument" line="243" name="changelog" /><variable default="PEAR_VALIDATE_NORMAL" ilk="argument" line="243" name="state" /><variable citdl="pkginfo[]" line="287" name="c" /><variable citdl="changelog" line="246" name="indent" /><variable line="313" name="file" /><variable citdl="pkginfo[]" line="269" name="dep" /><variable line="339" name="k" /><variable citdl="pkginfo[]" line="299" name="what" /><variable citdl="string" line="247" name="ret" /><variable citdl="pkginfo[]" line="313" name="fa" /><variable citdl="fa[]" line="337" name="r" /><variable line="299" name="key" /><variable citdl="r[]" line="339" name="v" /></scope><scope doc="@param array&#xA;@access protected" ilk="function" line="358" lineend="365" name="recursiveXmlFilelist" returns="this._formatDir()" signature="recursiveXmlFilelist($list)"><variable ilk="argument" line="358" name="list" /><variable citdl="list[]" line="361" name="attributes" /><variable line="361" name="file" /></scope><variable citdl="array()" line="360" name="_dirs" /><scope doc="@param array&#xA;@param array&#xA;@param string|null&#xA;@param array|null&#xA;@access private" ilk="function" line="374" lineend="385" name="_addDir" signature="_addDir(&amp; $dirs, $dir, $file = null, $attributes = null)"><variable ilk="argument" line="374" name="dirs" /><variable ilk="argument" line="374" name="dir" /><variable default="null" ilk="argument" line="374" name="file" /><variable default="null" ilk="argument" line="374" name="attributes" /><variable citdl="array_shift()" line="380" name="curdir" /></scope><scope doc="@param array&#xA;@param string&#xA;@param string&#xA;@access private" ilk="function" line="393" lineend="415" name="_formatDir" returns="string" signature="_formatDir($dirs, $indent = &apos;&apos;, $curdir = &apos;&apos;)"><variable ilk="argument" line="393" name="dirs" /><variable default="&apos;&apos;" ilk="argument" line="393" name="indent" /><variable default="&apos;&apos;" ilk="argument" line="393" name="curdir" /><variable citdl="string" line="402" name="usedir" /><variable citdl="dirs[]" line="410" name="attribs" /><variable citdl="string" line="395" name="ret" /><variable citdl="dirs[]" line="401" name="contents" /><variable line="410" name="file" /><variable line="401" name="dir" /></scope><scope doc="@param string&#xA;@param array&#xA;@param string&#xA;@access private" ilk="function" line="423" lineend="455" name="_formatFile" returns="ret" signature="_formatFile($file, $attributes, $indent)"><variable ilk="argument" line="423" name="file" /><variable ilk="argument" line="423" name="attributes" /><variable ilk="argument" line="423" name="indent" /><variable line="447" name="k" /><variable citdl="attributes[]" line="445" name="r" /><variable citdl="string" line="425" name="ret" /><variable citdl="r[]" line="447" name="v" /></scope><scope doc="&#xA;Unindent given string (?)&#xA;&lt;string&gt; $str  - The string that has to be unindented.&#xA;Returns string &#xA;Access private&#xA;" ilk="function" line="466" lineend="481" name="_unIndent" returns="string" signature="string _unIndent(string $str)"><variable citdl="string" ilk="argument" line="466" name="str" /><variable citdl="substr()" line="472" name="indent" /><variable citdl="explode()[]" line="475" name="line" /><variable citdl="strspn()" line="471" name="indent_len" /><variable citdl="string" line="473" name="data" /></scope><scope doc="&#xA;Returns array &#xA;" ilk="function" line="486" lineend="491" name="dependenciesToV2" returns="array" signature="array dependenciesToV2()"><variable citdl="array()" line="488" name="arr" /></scope><scope doc="&#xA;Convert a package.xml version 1.0 into version 2.0&#xA;Note that this does a basic conversion, to allow more advanced&#xA;features like bundles and multiple releases&#xA;&lt;string&gt; the  - classname to instantiate and return. This must be&#xA;              PEAR_PackageFile_v2 or a descendant&#xA;&lt;boolean&gt; if  - true, only valid, deterministic package.xml 1.0 as defined by the&#xA;               strictest parameters will be converted&#xA;Returns pear_packagefile_v2|pear_error &#xA;" ilk="function" line="504" lineend="700" name="toV2" returns="PEAR_PackageFile_v2" signature="pear_packagefile_v2 &amp;toV2($class = &apos;PEAR_PackageFile_v2&apos;, $strict = false)"><variable default="&apos;PEAR_PackageFile_v2&apos;" ilk="argument" line="504" name="class" /><variable default="false" ilk="argument" line="504" name="strict" /><variable citdl="PEAR.raiseError()" line="510" name="a" /><variable citdl="arr[]" line="632" name="opt" /><variable citdl="array()" line="528" name="arr" /><variable citdl="maintainers[]" line="532" name="maintainer" /><variable citdl="array()" line="619" name="temp" /><variable line="632" name="i" /><variable citdl="licensemap" line="671" name="uri" /><variable line="692" name="ret" /><variable citdl="this._packagefile.getMaintainers()" line="531" name="maintainers" /><variable citdl="array()" line="648" name="rel" /><variable citdl="cl[]" line="623" name="release" /><variable citdl="array()" line="541" name="new" /><variable citdl="array()" line="605" name="licensemap" /></scope><scope doc="@param array&#xA;@param bool&#xA;@access private" ilk="function" line="707" lineend="792" name="_convertDependencies2_0" signature="_convertDependencies2_0(&amp; $release, $internal = false)"><variable ilk="argument" line="707" name="release" /><variable default="false" ilk="argument" line="707" name="internal" /><variable citdl="current()" line="743" name="info" /><variable citdl="array()[]" line="721" name="arr" /><variable citdl="array()" line="710" name="peardep" /><variable citdl="key()" line="742" name="key" /><variable citdl="this._packagefile.getDeps()[]" line="714" name="dep" /><variable citdl="optional" line="711" name="required" /><variable citdl="release" line="786" name="bewm" /><variable citdl="array()" line="756" name="pkg" /><variable citdl="array()" line="722" name="deps" /><variable citdl="array()" line="736" name="php" /><variable citdl="array()" line="785" name="order" /></scope><scope doc="@param array&#xA;@access private" ilk="function" line="798" lineend="840" name="_convertFilelist2_0" returns="ret" signature="_convertFilelist2_0(&amp; $package)"><variable ilk="argument" line="798" name="package" /><variable citdl="this._packagefile.getFilelist()[]" line="809" name="file" /><variable citdl="file" line="815" name="repl" /><variable line="809" name="name" /><variable citdl="array()" line="805" name="ret" /><variable citdl="repl[]" line="830" name="replace" /></scope><variable citdl="boolean" line="808" name="_isExtension" /><scope doc="Post-process special files with install-as/platform attributes and&#xA;make the release tag.&#xA;&#xA;This complex method follows this work-flow to create the release tags:&#xA;&#xA;&lt;pre&gt;&#xA;- if any install-as/platform exist, create a generic release and fill it with&#xA;  o &lt;install as=..&gt; tags for &lt;file name=... install-as=...&gt;&#xA;  o &lt;install as=..&gt; tags for &lt;file name=... platform=!... install-as=..&gt;&#xA;  o &lt;ignore&gt; tags for &lt;file name=... platform=...&gt;&#xA;  o &lt;ignore&gt; tags for &lt;file name=... platform=... install-as=..&gt;&#xA;- create a release for each platform encountered and fill with&#xA;  o &lt;install as..&gt; tags for &lt;file name=... install-as=...&gt;&#xA;  o &lt;install as..&gt; tags for &lt;file name=... platform=this platform install-as=..&gt;&#xA;  o &lt;install as..&gt; tags for &lt;file name=... platform=!other platform install-as=..&gt;&#xA;  o &lt;ignore&gt; tags for &lt;file name=... platform=!this platform&gt;&#xA;  o &lt;ignore&gt; tags for &lt;file name=... platform=other platform&gt;&#xA;  o &lt;ignore&gt; tags for &lt;file name=... platform=other platform install-as=..&gt;&#xA;  o &lt;ignore&gt; tags for &lt;file name=... platform=!this platform install-as=..&gt;&#xA;&lt;/pre&gt;&#xA;&#xA;It does this by accessing the $package parameter, which contains an array with&#xA;indices:&#xA;&#xA; - platform: mapping of file =&gt; OS the file should be installed on&#xA; - install-as: mapping of file =&gt; installed name&#xA; - osmap: mapping of OS =&gt; list of files that should be installed&#xA;   on that OS&#xA; - notosmap: mapping of OS =&gt; list of files that should not be&#xA;   installed on that OS&#xA;&#xA;@param array&#xA;@param array&#xA;@access private" ilk="function" line="878" lineend="1090" name="_convertRelease2_0" signature="_convertRelease2_0(&amp; $release, $package)"><variable ilk="argument" line="878" name="release" /><variable ilk="argument" line="878" name="package" /><variable citdl="oses[]" line="929" name="releaseNum" /><variable line="1059" name="i" /><variable citdl="array()" line="882" name="generic" /><variable citdl="notplatform" line="913" name="oses" /><variable citdl="package" line="1034" name="installas" /><variable citdl="package[]" line="1076" name="value" /><variable citdl="release[]" line="1059" name="rel" /><variable citdl="package[]" line="903" name="platform" /><variable citdl="package[]" line="884" name="as" /><variable citdl="array()" line="883" name="genericIgnore" /><variable citdl="generic[]" line="884" name="file" /><variable citdl="package[]" line="914" name="os" /></scope><scope doc="@param array&#xA;@return array&#xA;@access private" ilk="function" line="1097" lineend="1146" name="_processDep" returns="array" signature="array _processDep($dep)"><variable ilk="argument" line="1097" name="dep" /><variable citdl="array()" line="1105" name="php" /></scope><scope doc="@param array&#xA;@return array" ilk="function" line="1152" lineend="1208" name="_processPhpDeps" returns="array" signature="array _processPhpDeps($deps)"><variable ilk="argument" line="1152" name="deps" /><variable citdl="array_flip()" line="1179" name="a" /><variable citdl="array()" line="1158" name="min" /><variable citdl="test[]" line="1155" name="dep" /><variable citdl="array()" line="1159" name="max" /><variable citdl="array()" line="1154" name="test" /><variable citdl="array()" line="1197" name="exclude" /></scope><scope doc="process multiple dependencies that have a name, like package deps&#xA;@param array&#xA;@return array&#xA;@access private" ilk="function" line="1216" lineend="1284" name="_processMultipleDepsName" returns="array" signature="array _processMultipleDepsName($deps)"><variable ilk="argument" line="1216" name="deps" /><variable citdl="array_flip()" line="1253" name="a" /><variable line="1219" name="name" /><variable citdl="array_pop()" line="1254" name="min" /><variable citdl="test[]" line="1219" name="dep" /><variable citdl="min" line="1226" name="max" /><variable citdl="tests" line="1218" name="ret" /><variable citdl="tests[]" line="1225" name="test" /><variable citdl="array()" line="1271" name="exclude" /><variable citdl="dep[]" line="1220" name="d" /></scope></scope></scope>